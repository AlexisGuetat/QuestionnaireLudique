{% extends "ATCAppBundle::index.html.twig" %}



{% block body %}

{# ON RECUPERE LE SOCRE ET LA NUMERO DE QUESTION PASSEE DANS L'URL #}
{% set numero_question = app.request.attributes.get('numero_question')|number_format %}
{% set score = app.request.attributes.get('score')|number_format %}


{# ON DEFINIT LA VALEUR DU TITRE #}
{% if questionnaire is defined %}
  {% set titre =  questionnaire.titre %}
{% elseif questionObj is defined %}
  {% set titre = "Calcul" %}
{% endif %}

{# ON DEFINIT LA VALEUR DE LA DIFFICULTE POUR LE PASSER EN PARAMENTRE POUR LA PAGE SCORE #}
{% if questionnaire is defined %}
  {% set difficulte_score =  questionnaire.difficulte.nom %}
{% elseif questionnaireMath is defined %}
  {% set difficulte_score = questionnaireMath.difficulte  %}
{% endif %}

{# ON DEFINIT LA VALEUR DE LA QUESTION #}
{% if questionnaire is defined %}
  {% set question =  listeQuestions[numero_question] %}
{% elseif questionObj is defined %}
  {% set question = questionObj %}
{% endif %}


<div class= " bg-transparent">
    
     <!-- Mask & flexbox options-->

     <!-- Content -->
     <div class=" white-text ">

            <div class="d-flex justify-content-around bd-highlight">
            <div id='titre' class="display-4 mb-2 mt-3 p-2 lg-5 bd-highlight"> <b>{{ titre }}</b> </div>
            <div class="display-4 mb-2 mt-3 p-2 bd-highlight"><u>Question N° <a id="numero_question" >{{ numero_question + 1 }}&nbsp;</u></a></div>
            <div id="countdown">
                <div id="countdown-number"></div>
                <svg>
                <circle id="cercle" cx="90" cy="90" r="60" ></circle>
                </svg>
            </div>
        </div>
        <!-- Section heading -->
        
                
      <h2 class="display-4 mb-5 mt-4" ><b>{{ question.intitule }}</b></h2>
          
        <!-- Grid row -->
        <div class="row justify-content-center">
            <div class="col-sm">
                <button name ="rep" id="rep0"   value="{{ question.reponseunjuste }}" 
                class="btn btn-lg  btn-primary col-xs-12 col-md-8"><b><i class="fas fa-question"></i>{{ question.reponseunjuste }}</b></button>
                <button name ="rep" id="rep1"  value="{{ question.reponsedeuxfausse }}" 
                class="btn btn-lg  btn-danger  col-xs-12 col-md-8"><b>{{ question.reponsedeuxfausse }}</b></button>
            </div>
            <div class="col-sm">
                <button  name ="rep" id="rep2" value=" {{ question.reponsetroisfausse }}" 
                class="btn btn-lg  btn-warning col-xs-12 col-md-8"><b>{{ question.reponsetroisfausse }}</b></button>
                <button  name ="rep" id="rep3" value=" {{ question.reponsequatrefausse }}" 
                class="btn btn-lg  btn-success col-xs-12 col-md-8"><b>{{ question.reponsequatrefausse }}</b></button>
            </div>            
        </div>
        <!-- Grid row -->

        <div class="progress mt-4 mb-6" style="height:40px">
           
            <div  id="progress_bar" class="progress-bar progress-bar-striped progress-bar-animated bg-success"  role="progressbar" style="width:0%">
                <b><a id="score" >{{ score }}</a> points</b>
            </div>
        </div> 
         
      </div>
    
</div>

{# MODAL DERNIERE QUESTION ATTEINT  #}
<div class="modal fade" id="centralModalScore" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-notify modal-warning" role="document">
    <!--Content-->
    <div class="modal-content">
      <!--Header-->
      <div class="modal-header">
        <p class="heading lead">&nbsp;FELICITATIONS&nbsp;<i class="fas fa-trophy fa-lg" style="color: white;"></i></p>

        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="white-text">&times;</span>
        </button>
      </div>

      <!--Body-->
      <div class="modal-body">
        <div class="text-center">
          <i class="fas fa-trophy fa-4x mb-3 animated rotateIn"></i>
          <p><i class="fas fa-star fa-spin fa-lg"></i>&nbsp;Tout nos félicitations !&nbsp;<i class="fas fa-star fa-spin fa-lg"></i></p><p> Tu viens de finir le questionnaire !</p>
          <p>Tu peux des a present voir ton score ! </p>
        </div>
      </div>

      <!--Footer-->
      <div class="modal-footer justify-content-center">
        <a  href="{{ path('score' ,{ 'nom_questionnaire' : titre , 'difficulte_questionnaire' : difficulte_score , 'score' : score }) }}"  class="btn btn-outline-warning waves-effect">&nbsp;Voir le score&nbsp;</i></a>
       
      </div>
    </div>
    <!--/.Content-->
  </div>
</div>
{% endblock %}

{% block modaux %}
 {{ include("ATCAppBundle:Questionnaire:modal.html.twig") }}
{% endblock %}

{% block footer %}
{{ parent() }}
<script src='{{ asset("js/questionnaire.js") }}' ></script>
<style>
        
        #countdown {
          position: relative;
          margin: auto;
          margin-top: 100px;
          margin-bottom: -100px;
          height: 300px;
          width: 300px;
          text-align: center;
    
          
        }
        
        .circle {
          padding:1px;
          width:300px;
          height:300px;
          border-style: solid;
          border-color:transparent;
           border-radius: 50%;
          border-width:1px;
          animation:rot 1s linear infinite; 
          padding:1px;
        }
        .circle > div {
          background:white;
          height: 299px;
          width: 299px;
          border-style: solid;
           border-radius: 50%;
          border-width:1px;
         
          
          
        }
    
    
        #countdown-number {
          color: greenyellow;
          display: inline-block;
          line-height: 80px;
          font-size: 90px;
        }
        
        svg {
          position: absolute;
          top: -170px;
          right: 0;
          left:-60px;
          width: 100%;
          height: 100%;
          transform: rotateY(-180deg) rotateZ(-90deg);
          
          
        }
    
        svg circle {
          stroke-dasharray: 400px;
          stroke-dashoffset: 0px;
          stroke-linecap: round;
          stroke-width: 15px;
          stroke: greenyellow;
          fill: none;
          animation: countdown 10s linear forwards; /* changer la valeur en s pour rentre proportionnel le décompte du timer a la disparition du cercle*/
    
          
        }
        
        @keyframes countdown {
          from {
            stroke-dashoffset: 0px;
          }
          to {
            stroke-dashoffset: 400px;
          }
        }</style>
{% endblock %}